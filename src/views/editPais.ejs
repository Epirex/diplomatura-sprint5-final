<div class="form-container">
  <h1 class="text-center">Editar País</h1>

  <% if (errores && errores.length > 0) { %>
    <div class="alert alert-danger">
      <ul>
        <% errores.forEach(error => { %>
          <li><%= error %></li>
        <% }) %>
      </ul>
    </div>
  <% } %>

  <form action="/paises/formulario/editar/<%= datos._id %>" method="POST">
    <input type="hidden" name="_id" value="<%= datos._id %>">

    <div class="form-grid">
      <!-- Nombre oficial -->
      <div class="form-group">
        <label>Nombre oficial en español</label>
        <input type="text" name="nombreEspanol" value="<%= datos?.nombreEspanol || '' %>" required>
      </div>

      <!-- Capital(es) -->
      <div class="form-group">
        <label>Capital(es)</label>
        <div id="capitalContainer">
          <% if (Array.isArray(datos?.capital)) { %>
            <% datos.capital.forEach(c => { %>
              <input type="text" name="capital[]" value="<%= c %>">
            <% }) %>
          <% } else { %>
            <input type="text" name="capital[]" value="<%= datos?.capital || '' %>">
          <% } %>
        </div>
        <button type="button" class="btn btn-sm btn-secondary mt-2" onclick="agregarCampo('capitalContainer', 'capital[]')">Agregar capital</button>
      </div>

      <!-- Fronteras -->
      <div class="form-group">
        <label>Fronteras (códigos de 3 letras)</label>
        <div id="fronteras-container">
          <% const fronteras = datos.fronteras || datos.borders || []; %>
          <% if (Array.isArray(fronteras)) { %>
            <% fronteras.forEach(f => { %>
              <input type="text" name="fronteras[]" value="<%= f %>" maxlength="3">
            <% }) %>
          <% } else { %>
            <input type="text" name="fronteras[]" maxlength="3">
          <% } %>
        </div>
        <button type="button" id="agregarFrontera" class="btn btn-sm btn-secondary mt-2">Agregar frontera</button>
      </div>

      <!-- Área -->
      <div class="form-group">
        <label>Área (km²)</label>
        <input type="number" step="any" name="area" value="<%= datos?.area || '' %>" required>
      </div>

      <!-- Población -->
      <div class="form-group">
        <label>Población</label>
        <input type="number" name="poblacion" value="<%= datos?.poblacion || datos?.population || '' %>" required>
      </div>

      <!-- Gini Año -->
      <div class="form-group">
        <label>Año del Gini:</label>
        <input type="number" name="giniAnio" value="<%= datos.giniAnio || '' %>">
      </div>

      <!-- Gini Valor -->
      <div class="form-group">
        <label>Valor del Gini:</label>
        <input type="number" step="0.01" name="gini" value="<%= datos.gini || '' %>">
      </div>

      <!-- Zonas horarias -->
      <div class="form-group">
        <label>Zonas Horarias</label>
        <div id="zonasHorariasContainer">
          <% if (Array.isArray(datos?.zonasHorarias)) { %>
            <% datos.zonasHorarias.forEach(z => { %>
              <input type="text" name="zonasHorarias[]" value="<%= z %>">
            <% }) %>
          <% } else if (datos?.zonasHorarias) { %>
            <input type="text" name="zonasHorarias[]" value="<%= datos.zonasHorarias %>">
          <% } else { %>
            <input type="text" name="zonasHorarias[]">
          <% } %>
        </div>
        <button type="button" class="btn btn-sm btn-secondary mt-2" onclick="agregarCampo('zonasHorariasContainer', 'zonasHorarias[]')">Agregar zona</button>
      </div>

      <!-- Creador -->
      <div class="form-group">
        <label>Creador</label>
        <input type="text" name="creador" value="<%= datos?.creador || '' %>" required>
      </div>
    </div>

    <div class="d-flex justify-content-between mt-4">
      <button type="submit" class="button btn-forms">Guardar Cambios</button>
      <a href="/paises" class="btn btn-secondary">Cancelar</a>
    </div>
  </form>
</div>

<script>
  function agregarCampo(containerId, name) {
    const container = document.getElementById(containerId);
    const input = document.createElement('input');
    input.type = 'text';
    input.name = name;
    input.className = 'form-control mb-1';
    container.appendChild(input);
  }

  document.getElementById('agregarFrontera').addEventListener('click', () => {
    agregarCampo('fronteras-container', 'fronteras[]');
  });
</script>


